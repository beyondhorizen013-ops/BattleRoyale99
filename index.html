<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle Royale 99 - Alpha V2 Fixed</title>
    <style>
        body { margin: 0; background: #111; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        canvas { display: none; background: #2e7d32; cursor: crosshair; }
        
        #menu-container { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: #111; z-index: 100;
        }
        .menu-box { background: rgba(0,0,0,0.8); padding: 50px; border-radius: 20px; border: 3px solid #00ccff; text-align: center; }
        h1 { font-size: 50px; color: #00ccff; margin: 5px; }
        .btn-play { padding: 20px 80px; font-size: 32px; font-weight: bold; color: white; background: #00ccff; border: none; border-radius: 50px; cursor: pointer; margin-bottom: 20px; }
        .btn-yt { display: inline-block; padding: 12px 35px; font-size: 18px; color: white; background: #ff0000; text-decoration: none; border-radius: 5px; }
        #ui { position: absolute; top: 10px; left: 10px; display: none; pointer-events: none; z-index: 10; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 200; }
    </style>
</head>
<body>

    <div id="menu-container">
        <div class="menu-box">
            <h1>BATTLE ROYALE 99</h1>
            <button class="btn-play" id="playBtn">PLAY</button><br>
            <a href="https://www.youtube.com/@BeyondCheese" target="_blank" class="btn-yt">YOUTUBE</a>
            <p>Thanks for playing!</p>
        </div>
    </div>

    <div id="ui">
        <h2 id="status">Alive: 100</h2>
        <div id="hp-text">HP: 100</div>
    </div>

    <div id="overlay">
        <h1>GAME OVER</h1>
        <button class="btn-play" onclick="location.reload()">RETRY</button>
    </div>

    <canvas id="game"></canvas>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const MAP_SIZE = 5000;
let aliveCount = 100;
let zoneRadius = 4500;
let gameActive = false;
let player = { x: 2500, y: 2500, hp: 100, weapon: 'Pistol' };
let bots = [], bullets = [], snacks = [], keys = {};

// Initialize World
for (let i = 0; i < 99; i++) bots.push({ x: Math.random()*MAP_SIZE, y: Math.random()*MAP_SIZE, hp: 100, alive: true, vx: 2, vy: 2 });
for (let i = 0; i < 40; i++) snacks.push({ x: Math.random()*MAP_SIZE, y: Math.random()*MAP_SIZE, active: true });

function update() {
    if (!gameActive) return;

    if (keys['w']) player.y -= 5; if (keys['s']) player.y += 5;
    if (keys['a']) player.x -= 5; if (keys['d']) player.x += 5;

    zoneRadius -= 0.2;
    if (Math.hypot(player.x - 2500, player.y - 2500) > zoneRadius) player.hp -= 0.1;

    snacks.forEach(s => {
        if (s.active && Math.hypot(player.x - s.x, player.y - s.y) < 30) {
            s.active = false; player.hp = Math.min(100, player.hp + 50);
        }
    });

    if (player.hp <= 0) { gameActive = false; document.getElementById('overlay').style.display = 'flex'; }
}

function draw() {
    if (!gameActive) return;
    ctx.clearRect(0,0,canvas.width, canvas.height);
    
    const camX = canvas.width/2 - player.x;
    const camY = canvas.height/2 - player.y;
    ctx.save(); ctx.translate(camX, camY);

    ctx.fillStyle = "#0f0"; snacks.forEach(s => { if(s.active) ctx.fillRect(s.x, s.y, 20, 20); });
    ctx.fillStyle = "red"; bots.forEach(b => { if(b.alive) ctx.fillRect(b.x, b.y, 20, 20); });
    ctx.strokeStyle = "white"; ctx.beginPath(); ctx.arc(2500, 2500, zoneRadius, 0, Math.PI*2); ctx.stroke();
    ctx.restore();

    ctx.fillStyle = "#00ccff"; ctx.fillRect(canvas.width/2-10, canvas.height/2-10, 20, 20);
    document.getElementById('hp-text').innerText = "HP: " + Math.ceil(player.hp);
    
    update();
    requestAnimationFrame(draw);
}

window.onkeydown = (e) => keys[e.key.toLowerCase()] = true;
window.onkeyup = (e) => keys[e.key.toLowerCase()] = false;

// THE FIX: Direct listener on the button
document.getElementById('playBtn').addEventListener('click', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    document.getElementById('menu-container').style.display = 'none';
    document.getElementById('ui').style.display = 'block';
    canvas.style.display = 'block';
    gameActive = true;
    draw();
});
</script>
</body>
</html>
